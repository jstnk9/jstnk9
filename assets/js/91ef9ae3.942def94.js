"use strict";(self.webpackChunkjstnk=self.webpackChunkjstnk||[]).push([[1664],{3905:function(e,t,a){a.d(t,{Zo:function(){return c},kt:function(){return u}});var i=a(7294);function n(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function o(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,i)}return a}function r(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?o(Object(a),!0).forEach((function(t){n(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):o(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function s(e,t){if(null==e)return{};var a,i,n=function(e,t){if(null==e)return{};var a,i,n={},o=Object.keys(e);for(i=0;i<o.length;i++)a=o[i],t.indexOf(a)>=0||(n[a]=e[a]);return n}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(i=0;i<o.length;i++)a=o[i],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(n[a]=e[a])}return n}var l=i.createContext({}),h=function(e){var t=i.useContext(l),a=t;return e&&(a="function"==typeof e?e(t):r(r({},t),e)),a},c=function(e){var t=h(e.components);return i.createElement(l.Provider,{value:t},e.children)},d={inlineCode:"code",wrapper:function(e){var t=e.children;return i.createElement(i.Fragment,{},t)}},p=i.forwardRef((function(e,t){var a=e.components,n=e.mdxType,o=e.originalType,l=e.parentName,c=s(e,["components","mdxType","originalType","parentName"]),p=h(a),u=n,m=p["".concat(l,".").concat(u)]||p[u]||d[u]||o;return a?i.createElement(m,r(r({ref:t},c),{},{components:a})):i.createElement(m,r({ref:t},c))}));function u(e,t){var a=arguments,n=t&&t.mdxType;if("string"==typeof e||n){var o=a.length,r=new Array(o);r[0]=p;var s={};for(var l in t)hasOwnProperty.call(t,l)&&(s[l]=t[l]);s.originalType=e,s.mdxType="string"==typeof e?e:n,r[1]=s;for(var h=2;h<o;h++)r[h]=a[h];return i.createElement.apply(null,r)}return i.createElement.apply(null,a)}p.displayName="MDXCreateElement"},1207:function(e,t,a){a.r(t),a.d(t,{frontMatter:function(){return s},contentTitle:function(){return l},metadata:function(){return h},assets:function(){return c},toc:function(){return d},default:function(){return u}});var i=a(7462),n=a(3366),o=(a(7294),a(3905)),r=["components"],s={slug:"Threat-modeling-and-strategic-vision-of-risks",title:"Threat modeling and strategic vision of risks",authors:"joseliyo",tags:["threat intelligence","cybersecurity","risk","threat modeling"]},l=void 0,h={permalink:"/jstnk9/blog/Threat-modeling-and-strategic-vision-of-risks",source:"@site/blog/2022-01-27-Threat-modeling-and-strategic-vision-of-risks/2022-01-27-Threat-modeling-and-strategic-vision-of-risks.md",title:"Threat modeling and strategic vision of risks",description:"TL;DR",date:"2022-01-27T00:00:00.000Z",formattedDate:"January 27, 2022",tags:[{label:"threat intelligence",permalink:"/jstnk9/blog/tags/threat-intelligence"},{label:"cybersecurity",permalink:"/jstnk9/blog/tags/cybersecurity"},{label:"risk",permalink:"/jstnk9/blog/tags/risk"},{label:"threat modeling",permalink:"/jstnk9/blog/tags/threat-modeling"}],readingTime:8.015,truncated:!0,authors:[{name:"Jose Luis S\xe1nchez Mart\xednez",title:"Security Researcher",url:"https://twitter.com/Joseliyo_Jstnk",imageURL:"https://jstnk9.github.io/jstnk9/img/profiles/1574890680450.jpeg",key:"joseliyo"}],prevItem:{title:"TIBER-EU and TIBER-ES - Threat Intelligence (I)",permalink:"/jstnk9/blog/TIBER-EU-ES-Threat-Intelligence-Series-01"},nextItem:{title:"Indicator life cycle applied to threat hunting",permalink:"/jstnk9/blog/Indicator-life-cycle-applied-to-threat-hunting"}},c={authorsImageUrls:[void 0]},d=[{value:"TL;DR",id:"tldr",children:[],level:2},{value:"Goal",id:"goal",children:[],level:2},{value:"Building the model",id:"building-the-model",children:[{value:"First level - Our assets",id:"first-level---our-assets",children:[],level:3},{value:"Second level - Motivations and objectives",id:"second-level---motivations-and-objectives",children:[],level:3},{value:"Third level - Searching actors",id:"third-level---searching-actors",children:[],level:3},{value:"Fourth level - Events and capabilities",id:"fourth-level---events-and-capabilities",children:[],level:3},{value:"Fifth level - MITRE ATT&amp;CK (Tactics and techniques)",id:"fifth-level---mitre-attck-tactics-and-techniques",children:[],level:3},{value:"Sixth level - Procedures",id:"sixth-level---procedures",children:[],level:3}],level:2}],p={toc:d};function u(e){var t=e.components,a=(0,n.Z)(e,r);return(0,o.kt)("wrapper",(0,i.Z)({},p,a,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("h2",{id:"tldr"},"TL;DR"),(0,o.kt)("p",null,"Thanks to threat modeling, a strategic view of the main threats can be given in order to focus prioritization efforts on those points where the greatest risk may exist."),(0,o.kt)("p",null,"From a Cyber Threat Intelligence vision, the focus is on the identification of actors and events along with the TTPs and Tradecraft used in them, thus relating it to the activity of our organization."),(0,o.kt)("p",null,"The model has an advantage in that it can be as flexible as we want, which helps to adapt to our intelligence needs."),(0,o.kt)("h2",{id:"goal"},"Goal"),(0,o.kt)("p",null,"The main objective of threat modeling is to know the information and/or assets that are considered critical for the organization's business, after which it can be related to potential threats that could carry out an attack to achieve their final objectives."),(0,o.kt)("p",null,"Having clear the above, the first thing is to know that information or assets that we think are important for the organization. To achieve this, we could ask ourselves the following question:"),(0,o.kt)("blockquote",null,(0,o.kt)("p",{parentName:"blockquote"},"What information and/or critical assets for the organization do I have to be the target of an attack?")),(0,o.kt)("p",null,"To be able to answer this question well, we must put ourselves from the point of view of a malicious actor whose objective is our organization. Of course, the answer to this question will vary ",(0,o.kt)("strong",{parentName:"p"},"depending on the sector to which our organization belongs and the activities it carries out"),", since if we were a bank, one of the clear objectives of a malicious actor would be to access information related to transactions however, if our organization is a critical infrastructure, one of the objectives could be to access and control the HMIs."),(0,o.kt)("p",null,"Once we know the objective that would motivate a malicious actor to attack us, it is time to make a model for our organization."),(0,o.kt)("h2",{id:"building-the-model"},"Building the model"),(0,o.kt)("p",null,"Before starting to work on our model, it is important to mention that it is advisable to update it periodically, either because the organization introduces new critical information or because there are new threats and different capabilities (there may also be threats that stop impacting organizations). organization operations)."),(0,o.kt)("p",null,"The first thing that has to be done, as mentioned in the previous point, is to ",(0,o.kt)("strong",{parentName:"p"},"identify the information or assets that are critical for the organization"),". In this example, our company will be called ACME and its activity will be related to the media sector."),(0,o.kt)("p",null,(0,o.kt)("img",{parentName:"p",src:"https://jstnk9.github.io/jstnk9/img/blog-threat-modeling/threat-modeling_1.png",alt:"Image_1"})),(0,o.kt)("h3",{id:"first-level---our-assets"},"First level - Our assets"),(0,o.kt)("p",null,"It is time to ask ourselves the question of the previous point."),(0,o.kt)("blockquote",null,(0,o.kt)("p",{parentName:"blockquote"},"What information and/or critical assets for the organization do I have to be the target of an attack?")),(0,o.kt)("p",null,"Bearing in mind that ACME organization is related to media sector, three critical points of the organization that may be susceptible to attacks will be listed below:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},(0,o.kt)("strong",{parentName:"p"},"Intellectual property")," of ACME on a generated good.")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},(0,o.kt)("strong",{parentName:"p"},"TV Production"),", thus referring to the production network where the direct television shows are found.")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},(0,o.kt)("strong",{parentName:"p"},"Future premieres")," that are agreed upon but are not public at the moment."))),(0,o.kt)("p",null,"Here is where we can add information obtained through the PPT methodology (People, process and technology)"),(0,o.kt)("p",null,(0,o.kt)("img",{parentName:"p",src:"https://jstnk9.github.io/jstnk9/img/blog-threat-modeling/threat-modeling_2.png",alt:"Image_2"})),(0,o.kt)("p",null,"In the first instance and being the most important, it has been possible to identify what the organization considers critical. In many cases, to obtain this information, interaction with different departments will be required and recommended to evaluate what they believe may seem important for the services and operation of the organization."),(0,o.kt)("h3",{id:"second-level---motivations-and-objectives"},"Second level - Motivations and objectives"),(0,o.kt)("p",null,"At this point and within the three blocks that have been defined in the model, one might think what types of threats would apply to this case due to their motivations and objectives. It is very important to place special emphasis on the ",(0,o.kt)("strong",{parentName:"p"},"objectives")," and ",(0,o.kt)("strong",{parentName:"p"},"motivations"),", since not all threats seek the same thing."),(0,o.kt)("p",null,"For the block of new premieres, an actor with industrial espionage motivations or espionage in general could be valid, whose objective is to find out about new television series premieres on the network. Would it be possible for an actor to deploy capabilities to spy on the ACME organization? Probably yes."),(0,o.kt)("p",null,"For the intellectual property block, an actor with espionage motivations could also be worth it, but in this case, instead of wanting to know new releases, their objective could be to exfiltrate intellectual property information to the public or sell it and obtain economic benefits."),(0,o.kt)("p",null,"Finally, for the TV production block, there could be a hacktivist motivation that has some kind of protest as its objective. These types of activities, in general, can leave without service or show personalized messages on the channels that are broadcast live on television."),(0,o.kt)("p",null,"Once the possible motivations that could exist for what has been defined as critical have been defined, it can be incorporated into the model and related."),(0,o.kt)("p",null,(0,o.kt)("img",{parentName:"p",src:"https://jstnk9.github.io/jstnk9/img/blog-threat-modeling/threat-modeling_3.png",alt:"Image_3"})),(0,o.kt)("h3",{id:"third-level---searching-actors"},"Third level - Searching actors"),(0,o.kt)("p",null,'The next step that must be taken so that the tree continues to take shape is to relate those threats that have been introduced at a high level, such as "hacktivists" and "actors with espionage motivation" at a lower level, giving them names and surnames.'),(0,o.kt)("p",null,"In this part, Cyber Threat Intelligence analysts come into play, who with their knowledge of the threat landscape that exists today together with their work tools, will be able to relate all those actors who carry out campaigns with these motivations."),(0,o.kt)("p",null,"To continue, there are two paths, being able to take one of the two, or even both, they are the following."),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},"Match high-level threats to APTs/Non-APT Groups that have the motivations and activities described above."),(0,o.kt)("li",{parentName:"ol"},"Relate high-level threats to actors who have been involved in past ",(0,o.kt)("strong",{parentName:"li"},"internal incidents"),". (This point should not be ignored, since the intelligence generated internally with past incidents can provide a better understanding of the threats that directly impact our organization)")),(0,o.kt)("p",null,(0,o.kt)("img",{parentName:"p",src:"https://jstnk9.github.io/jstnk9/img/blog-threat-modeling/threat-modeling_4.png",alt:"Image_4"})),(0,o.kt)("p",null,"As can be seen, and as an example so that it can serve as a reference, three different APTs have been added that have had the Media sector as their objective and that, in addition, one of their motivations has been espionage, having as a higher level intellectual property and future releases."),(0,o.kt)("p",null,"On the other hand, we have those threats linked to hacktivist activities, where it has been related to a group that has carried out attacks against our organization, specifically incidents number 45 and 51, for further reference."),(0,o.kt)("p",null,"The model grows in the form of a tree by itself and in a very agile way, helping to have an idea with just a glance of everything that could be a risk for the organization, and all this, with a down-to-earth context that is deals with critical information handled by ACME."),(0,o.kt)("p",null,"The model can grow as much as we want to make it grow. For example, at the point where it is, we could add those tools that the different actors have used to carry out their attacks. In this way, attack simulations could be carried out with the same tools to see the detection capabilities of the corresponding team that identifies and investigates this type of event."),(0,o.kt)("h3",{id:"fourth-level---events-and-capabilities"},"Fourth level - Events and capabilities"),(0,o.kt)("p",null,"It is true that if we have a large number of actors it could become a very large and unmanageable model, which is why at this point the figure of the CISO takes on a fundamental role, where he has to ",(0,o.kt)("strong",{parentName:"p"},"prioritize intelligence requirement"),"s by focusing on one actor or two ",(0,o.kt)("strong",{parentName:"p"},"in the first place"),", in this way progressive progress is achieved until the objective of minimizing the risks as much as possible is achieved. Suppose that in this case, there is a request to obtain information about the APT Sofacy."),(0,o.kt)("p",null,(0,o.kt)("img",{parentName:"p",src:"https://jstnk9.github.io/jstnk9/img/blog-threat-modeling/threat-modeling_5.png",alt:"Image_5"})),(0,o.kt)("p",null,"In this case, three blocks of capabilities used by the Sofacy APT are added (of course, all of them would have to be added). With a view to a better simulation of activity, it is interesting to add LOLBINS (Living Off The Land Binaries and Scripts) used in their campaigns so as not to be limited only to those tools that they have developed by themselves or taken advantage of code from others."),(0,o.kt)("p",null,"Also, as can be seen, there is a related event where an attack was carried out on the French-language international television channel TV5Monde. This attack can give us context of the motivations and objectives that the group had at a strategic level and provide us with information such as TTPs and Tradecraft at an operational level."),(0,o.kt)("p",null,(0,o.kt)("img",{parentName:"p",src:"https://jstnk9.github.io/jstnk9/img/blog-threat-modeling/threat-modeling_6.png",alt:"Image_6"}),"\nSource: bbc.com"),(0,o.kt)("h3",{id:"fifth-level---mitre-attck-tactics-and-techniques"},"Fifth level - MITRE ATT&CK (Tactics and techniques)"),(0,o.kt)("p",null,"Of course, as mentioned a little above, the model could continue to grow if necessary. Imagining that there is a tactical intelligence requirement to carry out operations as real as possible by a red team, it is requested to add the tactics and techniques of one of the capabilities that Sofacy executes, leaving the model as shown below."),(0,o.kt)("p",null,(0,o.kt)("img",{parentName:"p",src:"https://jstnk9.github.io/jstnk9/img/blog-threat-modeling/threat-modeling_7.png",alt:"Image_7"})),(0,o.kt)("h3",{id:"sixth-level---procedures"},"Sixth level - Procedures"),(0,o.kt)("p",null,"Finally, just for add more information to the model and make it actionable for the defenders, we can also add procedures of each technique used by the actors. This information can help us for make purple teaming exercises  in the future."),(0,o.kt)("p",null,(0,o.kt)("img",{parentName:"p",src:"https://jstnk9.github.io/jstnk9/img/blog-threat-modeling/threat-modeling_8.png",alt:"Image_8"})),(0,o.kt)("p",null,"Everything seen so far will be carried out according to the needs of each organization. In general, no two models are the same, even from two organizations in the same sector, since what may be critical for one may not be for the other."),(0,o.kt)("p",null,"If the objective is to be proactive in the face of threats that may affect the interests of an organization, threat modeling can help ",(0,o.kt)("strong",{parentName:"p"},"minimize risks")," and ",(0,o.kt)("strong",{parentName:"p"},"prioritize what is truly important.")),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"Twitter"),": ",(0,o.kt)("a",{parentName:"p",href:"https://twitter.com/Joseliyo_Jstnk"},"https://twitter.com/Joseliyo_Jstnk")),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"LinkedIn"),": ",(0,o.kt)("a",{parentName:"p",href:"https://www.linkedin.com/in/joseluissm/"},"https://www.linkedin.com/in/joseluissm/")))}u.isMDXComponent=!0}}]);