"use strict";(self.webpackChunkjstnk=self.webpackChunkjstnk||[]).push([[1090],{3905:function(e,t,n){n.d(t,{Zo:function(){return u},kt:function(){return p}});var a=n(7294);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},i=Object.keys(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var s=a.createContext({}),c=function(e){var t=a.useContext(s),n=t;return e&&(n="function"==typeof e?e(t):o(o({},t),e)),n},u=function(e){var t=c(e.components);return a.createElement(s.Provider,{value:t},e.children)},g={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},m=a.forwardRef((function(e,t){var n=e.components,r=e.mdxType,i=e.originalType,s=e.parentName,u=l(e,["components","mdxType","originalType","parentName"]),m=c(n),p=r,h=m["".concat(s,".").concat(p)]||m[p]||g[p]||i;return n?a.createElement(h,o(o({ref:t},u),{},{components:n})):a.createElement(h,o({ref:t},u))}));function p(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var i=n.length,o=new Array(i);o[0]=m;var l={};for(var s in t)hasOwnProperty.call(t,s)&&(l[s]=t[s]);l.originalType=e,l.mdxType="string"==typeof e?e:r,o[1]=l;for(var c=2;c<i;c++)o[c]=n[c];return a.createElement.apply(null,o)}return a.createElement.apply(null,n)}m.displayName="MDXCreateElement"},851:function(e,t,n){n.r(t),n.d(t,{frontMatter:function(){return l},contentTitle:function(){return s},metadata:function(){return c},assets:function(){return u},toc:function(){return g},default:function(){return p}});var a=n(7462),r=n(3366),i=(n(7294),n(3905)),o=["components"],l={slug:"MISP-object-creator-with-Virustotal-and-Sigma",title:"MISP object creator with VirusTotal and Sigma Galaxies",authors:"joseliyo",tags:["threat intelligence","blue team","cybersecurity","MISP","detection engineering","sigma","virustotal","threat hunting"]},s=void 0,c={permalink:"/jstnk9/blog/MISP-object-creator-with-Virustotal-and-Sigma",source:"@site/blog/2023-06-14-MISP-object-creator-with-Virustotal-and-Sigma/2023-06-14-MISP-object-creator-with-Virustotal-and-Sigma.md",title:"MISP object creator with VirusTotal and Sigma Galaxies",description:"TL;DR\u200b",date:"2023-06-14T00:00:00.000Z",formattedDate:"June 14, 2023",tags:[{label:"threat intelligence",permalink:"/jstnk9/blog/tags/threat-intelligence"},{label:"blue team",permalink:"/jstnk9/blog/tags/blue-team"},{label:"cybersecurity",permalink:"/jstnk9/blog/tags/cybersecurity"},{label:"MISP",permalink:"/jstnk9/blog/tags/misp"},{label:"detection engineering",permalink:"/jstnk9/blog/tags/detection-engineering"},{label:"sigma",permalink:"/jstnk9/blog/tags/sigma"},{label:"virustotal",permalink:"/jstnk9/blog/tags/virustotal"},{label:"threat hunting",permalink:"/jstnk9/blog/tags/threat-hunting"}],readingTime:5.77,truncated:!0,authors:[{name:"Jose Luis S\xe1nchez Mart\xednez",title:"Security Researcher",url:"https://twitter.com/Joseliyo_Jstnk",imageURL:"https://jstnk9.github.io/jstnk9/img/profiles/1574890680450.jpeg",key:"joseliyo"}],nextItem:{title:"Sigma Rules as MISP galaxies (II)",permalink:"/jstnk9/blog/Sigma-Rules-as-MISP-galaxies-02"}},u={authorsImageUrls:[void 0]},g=[{value:"TL;DR\u200b",id:"tldr",children:[],level:2}],m={toc:g};function p(e){var t=e.components,n=(0,r.Z)(e,o);return(0,i.kt)("wrapper",(0,a.Z)({},m,n,{components:t,mdxType:"MDXLayout"}),(0,i.kt)("h2",{id:"tldr"},"TL;DR\u200b"),(0,i.kt)("p",null,"I have created a new script to automate the ingestion of IOCs in MISP in object format. This script also automatically consumes information from VirusTotal to enrich the IOCs in case of exist in VT. However, the most interesting thing about this script is that it is able to automatically obtain the Sigma rules and MITRE techniques of the IOCs that we want to store in MISP, and add this information as Galaxies."),(0,i.kt)("p",null,"The stored galaxies are at the event level and at the object level, i.e. the event will have the total number of galaxies related to Sigma rules and MITRE techniques. Each object will have only the galaxies related to its behavior."),(0,i.kt)("p",null,"All you need to use the script is a VT API Key and to have the Sigma and MITRE galaxies in your instance. Since 2022-11-28 the Sigma galaxy ",(0,i.kt)("a",{parentName:"p",href:"https://github.com/MISP/misp-galaxy/blob/main/clusters/sigma-rules.json"},"is embedded")," in the default version of MISP. In case you don't have it, I recommend you to read ",(0,i.kt)("a",{parentName:"p",href:"https://jstnk9.github.io/jstnk9/blog/Sigma-Rules-as-MISP-galaxies"},"this blog")," and ",(0,i.kt)("a",{parentName:"p",href:"https://github.com/jstnk9/MISP/tree/main/misp-galaxy/sigma"},"use the script I made")," to create the sigma rules galaxy."))}p.isMDXComponent=!0}}]);