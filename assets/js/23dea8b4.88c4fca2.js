"use strict";(self.webpackChunkjstnk=self.webpackChunkjstnk||[]).push([[3770],{3905:function(e,t,n){n.d(t,{Zo:function(){return h},kt:function(){return u}});var a=n(7294);function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function l(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){i(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t){if(null==e)return{};var n,a,i=function(e,t){if(null==e)return{};var n,a,i={},r=Object.keys(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}var o=a.createContext({}),p=function(e){var t=a.useContext(o),n=t;return e&&(n="function"==typeof e?e(t):l(l({},t),e)),n},h=function(e){var t=p(e.components);return a.createElement(o.Provider,{value:t},e.children)},c={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},m=a.forwardRef((function(e,t){var n=e.components,i=e.mdxType,r=e.originalType,o=e.parentName,h=s(e,["components","mdxType","originalType","parentName"]),m=p(n),u=i,d=m["".concat(o,".").concat(u)]||m[u]||c[u]||r;return n?a.createElement(d,l(l({ref:t},h),{},{components:n})):a.createElement(d,l({ref:t},h))}));function u(e,t){var n=arguments,i=t&&t.mdxType;if("string"==typeof e||i){var r=n.length,l=new Array(r);l[0]=m;var s={};for(var o in t)hasOwnProperty.call(t,o)&&(s[o]=t[o]);s.originalType=e,s.mdxType="string"==typeof e?e:i,l[1]=s;for(var p=2;p<r;p++)l[p]=n[p];return a.createElement.apply(null,l)}return a.createElement.apply(null,n)}m.displayName="MDXCreateElement"},8215:function(e,t,n){var a=n(7294);t.Z=function(e){var t=e.children,n=e.hidden,i=e.className;return a.createElement("div",{role:"tabpanel",hidden:n,className:i},t)}},5064:function(e,t,n){n.d(t,{Z:function(){return m}});var a=n(7462),i=n(7294),r=n(2389),l=n(9443);var s=function(){var e=(0,i.useContext)(l.Z);if(null==e)throw new Error('"useUserPreferencesContext" is used outside of "Layout" component.');return e},o=n(3039),p=n(6010),h="tabItem_vU9c";function c(e){var t,n,a,r=e.lazy,l=e.block,c=e.defaultValue,m=e.values,u=e.groupId,d=e.className,g=i.Children.map(e.children,(function(e){if((0,i.isValidElement)(e)&&void 0!==e.props.value)return e;throw new Error("Docusaurus error: Bad <Tabs> child <"+("string"==typeof e.type?e.type:e.type.name)+'>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.')})),k=null!=m?m:g.map((function(e){var t=e.props;return{value:t.value,label:t.label}})),b=(0,o.lx)(k,(function(e,t){return e.value===t.value}));if(b.length>0)throw new Error('Docusaurus error: Duplicate values "'+b.map((function(e){return e.value})).join(", ")+'" found in <Tabs>. Every value needs to be unique.');var f=null===c?c:null!=(t=null!=c?c:null==(n=g.find((function(e){return e.props.default})))?void 0:n.props.value)?t:null==(a=g[0])?void 0:a.props.value;if(null!==f&&!k.some((function(e){return e.value===f})))throw new Error('Docusaurus error: The <Tabs> has a defaultValue "'+f+'" but none of its children has the corresponding value. Available values are: '+k.map((function(e){return e.value})).join(", ")+". If you intend to show no default tab, use defaultValue={null} instead.");var T=s(),v=T.tabGroupChoices,y=T.setTabGroupChoices,w=(0,i.useState)(f),N=w[0],I=w[1],E=[],j=(0,o.o5)().blockElementScrollPositionUntilNextRender;if(null!=u){var C=v[u];null!=C&&C!==N&&k.some((function(e){return e.value===C}))&&I(C)}var _=function(e){var t=e.currentTarget,n=E.indexOf(t),a=k[n].value;a!==N&&(j(t),I(a),null!=u&&y(u,a))},R=function(e){var t,n=null;switch(e.key){case"ArrowRight":var a=E.indexOf(e.currentTarget)+1;n=E[a]||E[0];break;case"ArrowLeft":var i=E.indexOf(e.currentTarget)-1;n=E[i]||E[E.length-1]}null==(t=n)||t.focus()};return i.createElement("div",{className:"tabs-container"},i.createElement("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,p.Z)("tabs",{"tabs--block":l},d)},k.map((function(e){var t=e.value,n=e.label;return i.createElement("li",{role:"tab",tabIndex:N===t?0:-1,"aria-selected":N===t,className:(0,p.Z)("tabs__item",h,{"tabs__item--active":N===t}),key:t,ref:function(e){return E.push(e)},onKeyDown:R,onFocus:_,onClick:_},null!=n?n:t)}))),r?(0,i.cloneElement)(g.filter((function(e){return e.props.value===N}))[0],{className:"margin-vert--md"}):i.createElement("div",{className:"margin-vert--md"},g.map((function(e,t){return(0,i.cloneElement)(e,{key:t,hidden:e.props.value!==N})}))))}function m(e){var t=(0,r.Z)();return i.createElement(c,(0,a.Z)({key:String(t)},e))}},9443:function(e,t,n){var a=(0,n(7294).createContext)(void 0);t.Z=a},7563:function(e,t,n){n.d(t,{Z:function(){return m}});var a=n(7294),i="browserWindow_CU2T",r="browserWindowHeader_9KMa",l="buttons_HaVU",s="browserWindowAddressBar_ep3W",o="dot_AgBE",p="browserWindowMenuIcon_mrOC",h="bar_CAZr",c="browserWindowBody_jHfO";var m=function(e){var t=e.children,n=e.minHeight,m=e.url,u=void 0===m?"http://localhost:3000":m;return a.createElement("div",{className:i,style:{minHeight:n}},a.createElement("div",{className:r},a.createElement("div",{className:l},a.createElement("span",{className:o,style:{background:"#f25f58"}}),a.createElement("span",{className:o,style:{background:"#fbbe3c"}}),a.createElement("span",{className:o,style:{background:"#58cb42"}})),a.createElement("div",{className:s},u),a.createElement("div",{className:p},a.createElement("div",null,a.createElement("span",{className:h}),a.createElement("span",{className:h}),a.createElement("span",{className:h})))),a.createElement("div",{className:c},t))}},7830:function(e,t,n){n.r(t),n.d(t,{frontMatter:function(){return h},contentTitle:function(){return c},metadata:function(){return m},assets:function(){return u},toc:function(){return d},default:function(){return k}});var a=n(7462),i=n(3366),r=(n(7294),n(3905)),l=n(5064),s=n(8215),o=n(7563),p=["components"],h={slug:"TIBER-EU-ES-Threat-Intelligence-Series-01",title:"TIBER-EU and TIBER-ES - Threat Intelligence (I)",authors:"joseliyo",tags:["threat intelligence","cybersecurity","risk","threat modeling","financial services","tiber-eu","tiber-es"]},c=void 0,m={permalink:"/jstnk9/blog/TIBER-EU-ES-Threat-Intelligence-Series-01",source:"@site/blog/2022-02-10-TIBER-EUES-Threat-Intelligence-Series-01/2022-02-10-TIBER-EUES-Threat-Intelligence-Series-01.md",title:"TIBER-EU and TIBER-ES - Threat Intelligence (I)",description:"TL;DR",date:"2022-02-10T00:00:00.000Z",formattedDate:"February 10, 2022",tags:[{label:"threat intelligence",permalink:"/jstnk9/blog/tags/threat-intelligence"},{label:"cybersecurity",permalink:"/jstnk9/blog/tags/cybersecurity"},{label:"risk",permalink:"/jstnk9/blog/tags/risk"},{label:"threat modeling",permalink:"/jstnk9/blog/tags/threat-modeling"},{label:"financial services",permalink:"/jstnk9/blog/tags/financial-services"},{label:"tiber-eu",permalink:"/jstnk9/blog/tags/tiber-eu"},{label:"tiber-es",permalink:"/jstnk9/blog/tags/tiber-es"}],readingTime:10.31,truncated:!0,authors:[{name:"Jose Luis S\xe1nchez Mart\xednez",title:"Security Researcher",url:"https://twitter.com/Joseliyo_Jstnk",imageURL:"https://jstnk9.github.io/jstnk9/img/profiles/1574890680450.jpeg",key:"joseliyo"}],prevItem:{title:"TIBER-EU and TIBER-ES - Red Team",permalink:"/jstnk9/blog/TIBER-EU-ES-Red-Team-Series-01"},nextItem:{title:"Threat modeling and strategic vision of risks",permalink:"/jstnk9/blog/Threat-modeling-and-strategic-vision-of-risks"}},u={authorsImageUrls:[void 0]},d=[{value:"TL;DR",id:"tldr",children:[],level:2},{value:"Abbreviations",id:"abbreviations",children:[],level:2},{value:"Context",id:"context",children:[],level:2},{value:"Goal of this project and blog",id:"goal-of-this-project-and-blog",children:[],level:2},{value:"Process",id:"process",children:[{value:"Generic Threat Landscape (GTL Report)",id:"generic-threat-landscape-gtl-report",children:[],level:3},{value:"Targeted Threat Intelligence (TTI Report)",id:"targeted-threat-intelligence-tti-report",children:[],level:3}],level:2},{value:"The Hive",id:"the-hive",children:[{value:"Import Case",id:"import-case",children:[],level:3},{value:"Case visualization",id:"case-visualization",children:[],level:3},{value:"Cases information",id:"cases-information",children:[],level:3}],level:2}],g={toc:d};function k(e){var t=e.components,n=(0,i.Z)(e,p);return(0,r.kt)("wrapper",(0,a.Z)({},g,n,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("h2",{id:"tldr"},"TL;DR"),(0,r.kt)("p",null,"After the Bank of Spain (BDE) published the TIBER-ES guide adapted to the national territory in January 2022, I was thinking about the complexity that in some cases it would entail for Threat Intelligence and Red Team providers to give this service to financial entities."),(0,r.kt)("p",null,"For this reason, I wanted to carry out a development so that the Threat Intelligence teams speed up their work through predefined cases of the famous platform used in the world of CTI called ",(0,r.kt)("strong",{parentName:"p"},(0,r.kt)("a",{parentName:"strong",href:"https://thehive-project.org/"},"The Hive")),"."),(0,r.kt)("p",null,"The developed cases contemplate all the phases that TIBER-EU mentions in its documentation, in addition I have also included good practices and ways of facing some phases."),(0,r.kt)("p",null,"The fact of using The Hive is due to the following reasons:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Allows to merge cases"),(0,r.kt)("li",{parentName:"ul"},"Can be integrated with MISP"),(0,r.kt)("li",{parentName:"ul"},"Can be integrated with Cortex and its analyzers"),(0,r.kt)("li",{parentName:"ul"},"Case templates can be created")),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"GitHub project"),": ",(0,r.kt)("a",{parentName:"p",href:"https://github.com/jstnk9/TIBER-Cases"},"https://github.com/jstnk9/TIBER-Cases")),(0,r.kt)("h2",{id:"abbreviations"},"Abbreviations"),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null},"Key"),(0,r.kt)("th",{parentName:"tr",align:null},"Description"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"Entity"),(0,r.kt)("td",{parentName:"tr",align:null},"The term Entity during this blog and The Hive cases, refers to the entity that is going to carry out the TIBER-EU exercises.")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"TI"),(0,r.kt)("td",{parentName:"tr",align:null},"Threat Intelligence Provider. Is the provider of threat intelligence services for the Entity.")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"RT"),(0,r.kt)("td",{parentName:"tr",align:null},"Red Team Provider. Is the provider of red teaming services for the Entity.")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"WT"),(0,r.kt)("td",{parentName:"tr",align:null},"White Team. Team responsible of the scope and operative execution of the exercises.")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"BT"),(0,r.kt)("td",{parentName:"tr",align:null},"Blue Team. Team without  knowledge about the exercise which have to respond to the attacks by the RT.")))),(0,r.kt)("h2",{id:"context"},"Context"),(0,r.kt)("p",null,"During this blog I will not go into detail about what TIBER-EU or TIBER-ES is. I will simply mention that TIBER-EU is a European framework for testing red teaming with a threat intelligence approach. This approach is related to Lockheed Martin's well-known Intelligence Driven Defense\xae method."),(0,r.kt)("p",null,"The offensive tests will be from the perspective of actual attacks with procedures used by actors targeting the financial sector. For more information, I recommend reading the TIBER-EU and TIBER-ES guides."),(0,r.kt)("div",{className:"admonition admonition-info alert alert--info"},(0,r.kt)("div",{parentName:"div",className:"admonition-heading"},(0,r.kt)("h5",{parentName:"div"},(0,r.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,r.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,r.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"}))),"info")),(0,r.kt)("div",{parentName:"div",className:"admonition-content"},(0,r.kt)("p",{parentName:"div"},(0,r.kt)("strong",{parentName:"p"},"TIBER-EU Information: ",(0,r.kt)("a",{parentName:"strong",href:"https://www.ecb.europa.eu/paym/cyber-resilience/tiber-eu/html/index.en.html"},"https://www.ecb.europa.eu/paym/cyber-resilience/tiber-eu/html/index.en.html"))),(0,r.kt)("p",{parentName:"div"},(0,r.kt)("strong",{parentName:"p"},"TIBER-ES Information: ",(0,r.kt)("a",{parentName:"strong",href:"https://www.bde.es/bde/es/secciones/servicios/tiber-es-3f6bfe7e907ed71.html"},"https://www.bde.es/bde/es/secciones/servicios/tiber-es-3f6bfe7e907ed71.html"))))),(0,r.kt)("h2",{id:"goal-of-this-project-and-blog"},"Goal of this project and blog"),(0,r.kt)("p",null,"The main objective of this project is to ",(0,r.kt)("strong",{parentName:"p"},"help TI analysts")," during the testing phase (testing phase is the name given by TIBER). To do this, different cases are made available that can be imported into The Hive and thus be able to speed up the work."),(0,r.kt)("p",null,"For this, a total of 6 cases have been developed, which have sub-tasks assigned to different types of threat intelligence analysts (tactical, operational and strategic levels)."),(0,r.kt)("p",null,"The phases of the red team and blue team will not be covered during this blog and neither in the cases of The Hive. In future posts I make, I will generate new cases for those teams."),(0,r.kt)("p",null,"Finally, in the phases and steps that come in this blog, it will not go into excessive detail about what needs to be done, since, in the cases that I have developed for The Hive, I put the necessary information for the threat intelligence analysts."),(0,r.kt)("h2",{id:"process"},"Process"),(0,r.kt)("p",null,"The process that TIBER-EU makes available to the community is very interesting. The following image shows the activities carried out by the TI team within the testing phase."),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://jstnk9.github.io/jstnk9/img/blog-tiber01/tiber_intelligence.png",alt:"tiberIntel_process"})),(0,r.kt)("p",null,"source: ecb.europa.eu "),(0,r.kt)("p",null,'To simplify the entire TIBER-EU document and the Threat Intelligence section a bit, I wanted to make a process explaining the most important points of the framework for those analysts who are going to work on it. Specifically, I have focused on the "Processes/Activities Threat Intelligence" section of the official TIBER-EU process.'),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://jstnk9.github.io/jstnk9/img/blog-tiber01/jstnk_tiber.png",alt:"jstnk_tiber"})),(0,r.kt)("h3",{id:"generic-threat-landscape-gtl-report"},"Generic Threat Landscape (GTL Report)"),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://jstnk9.github.io/jstnk9/img/blog-tiber01/gtl_drk.png#gh-dark-mode-only",alt:"GTL"}),(0,r.kt)("img",{parentName:"p",src:"https://jstnk9.github.io/jstnk9/img/blog-tiber01/gtl_wht.png#gh-light-mode-only",alt:"jsis"})),(0,r.kt)("p",null,"Before starting, it should be made clear that the objective of the GTL Report is, as its name indicates, to generate a ",(0,r.kt)("strong",{parentName:"p"},"generic")," report about the financial landscape."),(0,r.kt)("p",null,"That said, we must start by knowing our adversaries, for this, we will have to access different sources of information, if possible about threats from the financial sector. Some resources that we can use in order to know these financial threats may be the following."),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Reports developed by Cybersecurity Companies"),(0,r.kt)("li",{parentName:"ul"},"Reports developed by FS-ISAC"),(0,r.kt)("li",{parentName:"ul"},"Reports developed by Government Agencies")),(0,r.kt)("p",null,"Depending on the country to which the ",(0,r.kt)("inlineCode",{parentName:"p"},"Entity")," belongs and/or operates, we must focus on threats from the financial sector, with geopolitical considerations of the country and possible criminal groups that carry out operations against said sector (it is important not to focus only in APTs)."),(0,r.kt)("p",null,"With this information, it is recommended to generate a generic report on the adversaries identified as potential."),(0,r.kt)("p",null,"In the event that resources or time are not available to carry out this report, it is advisable to use public reports on past intrusions against the financial sector. The GTL report is optional, it is not mandatory, however, TIBER-EU recommends doing it :-)."),(0,r.kt)("h3",{id:"targeted-threat-intelligence-tti-report"},"Targeted Threat Intelligence (TTI Report)"),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://jstnk9.github.io/jstnk9/img/blog-tiber01/TTI_drk.png#gh-dark-mode-only",alt:"TTI"}),(0,r.kt)("img",{parentName:"p",src:"https://jstnk9.github.io/jstnk9/img/blog-tiber01/TTI_wht.png#gh-light-mode-only",alt:"jsis"})),(0,r.kt)("p",null,"During the TTI phase, the clear objectives that the TI team has to achieve are summarized below."),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},"Contextualize the information from the GTL Report to the ",(0,r.kt)("inlineCode",{parentName:"li"},"Entity"),". This is achieved by identifying critical functions of the ",(0,r.kt)("inlineCode",{parentName:"li"},"Entity")," with its help"),(0,r.kt)("li",{parentName:"ol"},"Share intelligence between the TI teams of the ",(0,r.kt)("inlineCode",{parentName:"li"},"Entity")," and the TI Provider"),(0,r.kt)("li",{parentName:"ol"},"Focus the analysis efforts on two key points (Target and Threat) that will be described in the following points"),(0,r.kt)("li",{parentName:"ol"},"Create flags for the RT to get during his offensive tests. These flags must be contextualized with the information obtained from the ",(0,r.kt)("inlineCode",{parentName:"li"},"Entity")),(0,r.kt)("li",{parentName:"ol"},"Create scenarios as real as possible about attacks that could occur in the ",(0,r.kt)("inlineCode",{parentName:"li"},"Entity"),". These scenarios must be mapped to the kill chain to make each objective in each phase clear to the RT."),(0,r.kt)("li",{parentName:"ol"},"Finally, a complete report will be generated with all the information. This report will be the entry point for the RT.")),(0,r.kt)("h3",null,"Step 1 - Context "),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://jstnk9.github.io/jstnk9/img/blog-tiber01/step1_drk.png#gh-dark-mode-only",alt:"step1"}),(0,r.kt)("img",{parentName:"p",src:"https://jstnk9.github.io/jstnk9/img/blog-tiber01/step1_wht.png#gh-light-mode-only",alt:"jsis"})),(0,r.kt)("p",null,"The first step, as mentioned above, aims to contextualize the GTL report on the ",(0,r.kt)("inlineCode",{parentName:"p"},"Entity"),". During this step, we will have to exchange information (as a list of assets, departments, services, etc.) with the ",(0,r.kt)("inlineCode",{parentName:"p"},"Entity"),", this will help us to understand more how your business works and possible assets considered as critical."),(0,r.kt)("p",null,"If possible, it is also highly recommended to ask the entity for reports on recent intrusions that they may have suffered. That information may later lead to possible scenarios."),(0,r.kt)("p",null,"Ask yourself a question. How can you defend something if you don't know it? It is very important to know the ",(0,r.kt)("inlineCode",{parentName:"p"},"Entity's")," business"),(0,r.kt)("h3",null,"Step 2 - Sharing Intelligence"),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://jstnk9.github.io/jstnk9/img/blog-tiber01/step2_drk.png#gh-dark-mode-only",alt:"step2"}),(0,r.kt)("img",{parentName:"p",src:"https://jstnk9.github.io/jstnk9/img/blog-tiber01/step2_wht.png#gh-light-mode-only",alt:"jsis"})),(0,r.kt)("p",null,"The second step is entirely focused on sharing intelligence between the two TI teams. This sharing can be done through structured formats supported by technology (see STIX, MISP, etc...) as in PDF formats or any other on reports made by the TI team of the ",(0,r.kt)("inlineCode",{parentName:"p"},"Entity"),"."),(0,r.kt)("p",null,"Within this activity, it has more value if the ",(0,r.kt)("inlineCode",{parentName:"p"},"Entity")," shares intelligence generated by itself than that which it has consumed from third parties."),(0,r.kt)("h3",null,"Step 3 - Analysis"),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://jstnk9.github.io/jstnk9/img/blog-tiber01/step3_drk.png#gh-dark-mode-only",alt:"step3"}),(0,r.kt)("img",{parentName:"p",src:"https://jstnk9.github.io/jstnk9/img/blog-tiber01/step3_wht.png#gh-light-mode-only",alt:"jsis"})),(0,r.kt)("p",null,"This is the most important step and in which you should invest more time. The analyzes should be separated into two key aspects."),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},(0,r.kt)("strong",{parentName:"p"},"Target"),": It is based on understanding the exposure of the ",(0,r.kt)("inlineCode",{parentName:"p"},"Entity")," from the point of view of an actor. Identify processes, people and potential technology to be targeted.")),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},(0,r.kt)("strong",{parentName:"p"},"Threat"),": We will have to map the motivations, objectives and TTPs of the adversaries with the interests of the ",(0,r.kt)("inlineCode",{parentName:"p"},"Entity"),". For this, a ",(0,r.kt)("a",{parentName:"p",href:"https://jstnk9.github.io/jstnk9/blog/Threat-modeling-and-strategic-vision-of-risks"},"Threat Modeling")," will also have to be carried out to help us with this evaluation. The use of MITRE in this section is very important."))),(0,r.kt)("p",null,"Make sure the information captured from Threat maps to Target. Just an example, imagine that the ",(0,r.kt)("inlineCode",{parentName:"p"},"Entity")," hasn't Windows Servers, then..."),(0,r.kt)("div",{className:"admonition admonition-tip alert alert--success"},(0,r.kt)("div",{parentName:"div",className:"admonition-heading"},(0,r.kt)("h5",{parentName:"div"},(0,r.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,r.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"12",height:"16",viewBox:"0 0 12 16"},(0,r.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"}))),"Think about this.. Minimize your efforts")),(0,r.kt)("div",{parentName:"div",className:"admonition-content"},(0,r.kt)("p",{parentName:"div"},(0,r.kt)("strong",{parentName:"p"},"Why do you map procedures against Windows Server if the ",(0,r.kt)("inlineCode",{parentName:"strong"},"Entity")," doesn't have?")))),(0,r.kt)("p",null,"It doesn't make sense for you to simulate adversarial sharing scenarios against Windows Server if it's never going to have an impact on the ",(0,r.kt)("inlineCode",{parentName:"p"},"Entity"),"."),(0,r.kt)("h3",null," Step 4 - Flags"),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://jstnk9.github.io/jstnk9/img/blog-tiber01/step4_drk.png#gh-dark-mode-only",alt:"step4"}),(0,r.kt)("img",{parentName:"p",src:"https://jstnk9.github.io/jstnk9/img/blog-tiber01/step4_wht.png#gh-light-mode-only",alt:"jsis"})),(0,r.kt)("p",null,"Setting flags for the RT to get is challenging. The flags must be realistic, from the point of view that an actor could also get said flag. All those flags must be contextualized with the ",(0,r.kt)("inlineCode",{parentName:"p"},"Entity"),". They can range from targeting a specific person to open an email to exploiting an exposed service known to have vulnerabilities."),(0,r.kt)("h3",null," Step 5 - Create Scenarios"),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://jstnk9.github.io/jstnk9/img/blog-tiber01/step5_drk.png#gh-dark-mode-only",alt:"step5"}),(0,r.kt)("img",{parentName:"p",src:"https://jstnk9.github.io/jstnk9/img/blog-tiber01/step5_wht.png#gh-light-mode-only",alt:"jsis"})),(0,r.kt)("p",null,"The last step is related to creating scenarios for the RT to execute and get those previously set flags. Think that these scenarios can be carried out by real opponents. It is important to spell out at a very low level what you want the RT to do."),(0,r.kt)("p",null,"The procedures must be described in full detail, for example, if you want the RT to execute a command with a specific parameter, it must be indicated like this."),(0,r.kt)("p",null,"Finally, all the scenarios that are developed must be mapped to the phases of the kill chain, which have a specific task in the case generated for this step."),(0,r.kt)("h2",{id:"the-hive"},"The Hive"),(0,r.kt)("h3",{id:"import-case"},"Import Case"),(0,r.kt)("p",null,"Version of The Hive used:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-yaml"},"Scalligraph: 0.1.0-SNAPSHOT\nTheHive: 4.1.18-1\nPlay: 2.8.7\n")),(0,r.kt)("p",null,"Before you begin, I highly recommend following the guide below to import the ATT&CK MITRE Matrix and MISP taxonomies into The Hive. To do this, go to the following links."),(0,r.kt)("div",{className:"admonition admonition-info alert alert--info"},(0,r.kt)("div",{parentName:"div",className:"admonition-heading"},(0,r.kt)("h5",{parentName:"div"},(0,r.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,r.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,r.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"}))),"info")),(0,r.kt)("div",{parentName:"div",className:"admonition-content"},(0,r.kt)("p",{parentName:"div"},"Import ATT&CK MITRE: ",(0,r.kt)("a",{parentName:"p",href:"https://docs.thehive-project.org/thehive/user-guides/administrators/tactics-techniques-procedures/"},"https://docs.thehive-project.org/thehive/user-guides/administrators/tactics-techniques-procedures/")),(0,r.kt)("p",{parentName:"div"},"Import MISP Taxonomies: ",(0,r.kt)("a",{parentName:"p",href:"https://docs.thehive-project.org/thehive/user-guides/administrators/tags-and-taxonomies/"},"https://docs.thehive-project.org/thehive/user-guides/administrators/tags-and-taxonomies/")))),(0,r.kt)("p",null,"To import the cases, you must have permissions to perform this task. To do this, you must first navigate to the ",(0,r.kt)("inlineCode",{parentName:"p"},"Organization")," section that is located at the top next to the search bar."),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://jstnk9.github.io/jstnk9/img/blog-tiber01/tutorial1.png",alt:"step1"})),(0,r.kt)("p",null,"Once inside that section, we will have to go to the section that says ",(0,r.kt)("inlineCode",{parentName:"p"},"Import template")," and select the JSON files that are in my GitHub, specifically in the ",(0,r.kt)("inlineCode",{parentName:"p"},"cases")," folder."),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://jstnk9.github.io/jstnk9/img/blog-tiber01/tutorial2.png",alt:"step2"})),(0,r.kt)("p",null,"Once this is done, and when we click on the upper part where it says ",(0,r.kt)("inlineCode",{parentName:"p"},"+ New Case"),", all the imported cases will appear with the information about the TIBER-EU phases."),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://jstnk9.github.io/jstnk9/img/blog-tiber01/tutorial3.png",alt:"step3"})),(0,r.kt)("h3",{id:"case-visualization"},"Case visualization"),(0,r.kt)("p",null,"As an example, once the cases are imported and one is generated to start working on it, they look like the following image:"),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://jstnk9.github.io/jstnk9/img/blog-tiber01/gtl_case01.png",alt:"gtl_case"})),(0,r.kt)("p",null,"As can be seen, it contains all the information the analyst needs to start working. The way cases are written is by using ",(0,r.kt)("inlineCode",{parentName:"p"},"markdown"),"."),(0,r.kt)("p",null,"When clicking on ",(0,r.kt)("inlineCode",{parentName:"p"},"tasks"),", the user can see the following information."),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://jstnk9.github.io/jstnk9/img/blog-tiber01/gtl_case03.png",alt:"gtl_case_tasks"})),(0,r.kt)("p",null,"All the Tasks that are included in each case have ",(0,r.kt)("inlineCode",{parentName:"p"},"dependencies")," and ",(0,r.kt)("inlineCode",{parentName:"p"},"goals"),", this will help the analysts not lose focus and focus on the goals to be achieved."),(0,r.kt)("h3",{id:"cases-information"},"Cases information"),(0,r.kt)("p",null,"Here you can find basic information about the created cases. Case name is the name defined for each case. Each case has different tasks to complete. You'll find all the information in the json files."),(0,r.kt)(o.Z,{url:"http://thehive:9000/cases/",mdxType:"BrowserWindow"},(0,r.kt)(l.Z,{mdxType:"Tabs"},(0,r.kt)(s.Z,{value:"GTL",label:"GTL",default:!0,mdxType:"TabItem"},(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Case name:")," Generic Threat Landscape (GTL)"),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Tasks:")),(0,r.kt)("li",null,"Task #1 - Source Collection"),(0,r.kt)("li",null,"Task #2 - Focus criteria"),(0,r.kt)("li",null,"Task #3 - GTL Report"),(0,r.kt)("br",null),(0,r.kt)("p",null,"\ud83d\udd0e ",(0,r.kt)("a",{href:"https://github.com/jstnk9/TIBER-Cases/blob/main/cases/threat_intelligence_provider/Case-Template__Generic_Threat_Landscape_GTL.json",target:"_blank"}," JSON File "))),(0,r.kt)(s.Z,{value:"TTI - Step 1",label:"TTI - Step 1",mdxType:"TabItem"},(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Case name:")," Targeted Threat Intelligence (TTI) #1 - Context"),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Tasks:")),(0,r.kt)("li",null,"Task #1 - Request for Information"),(0,r.kt)("li",null,"Task #2 - Mapping context to threats"),(0,r.kt)("br",null),(0,r.kt)("p",null,"\ud83d\udd0e ",(0,r.kt)("a",{href:"https://github.com/jstnk9/TIBER-Cases/blob/main/cases/threat_intelligence_provider/Case-Template__Targeted_Threat_Intelligence_TTI_1_Context.json",target:"_blank"}," JSON File "))),(0,r.kt)(s.Z,{value:"TTI - Step 2",label:"TTI - Step 2",mdxType:"TabItem"},(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Case name:")," Targeted Threat Intelligence (TTI) #2 - Sharing Intelligence"),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Tasks:")),(0,r.kt)("li",null,"Task #1 - Sharing Intelligence"),(0,r.kt)("br",null),(0,r.kt)("p",null,"\ud83d\udd0e ",(0,r.kt)("a",{href:"https://github.com/jstnk9/TIBER-Cases/blob/main/cases/threat_intelligence_provider/Case-Template__Targeted_Threat_Intelligence_TTI_2_Sharing_Intelligence.json",target:"_blank"}," JSON File "))),(0,r.kt)(s.Z,{value:"TTI - Step 3",label:"TTI - Step 3",mdxType:"TabItem"},(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Case name:")," Targeted Threat Intelligence (TTI) #3 - Analysis"),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Tasks:")," "),(0,r.kt)("li",null,"Task #1 - Target"),(0,r.kt)("li",null,"Task #2 - Threat"),(0,r.kt)("li",null,"Task #3 - Threat Modeling"),(0,r.kt)("br",null),(0,r.kt)("p",null,"\ud83d\udd0e ",(0,r.kt)("a",{href:"https://github.com/jstnk9/TIBER-Cases/blob/main/cases/threat_intelligence_provider/Case-Template__Targeted_Threat_Intelligence_TTI_3_Analysis.json",target:"_blank"}," JSON File "))),(0,r.kt)(s.Z,{value:"TTI - Step 4",label:"TTI - Step 4",mdxType:"TabItem"},(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Case name:")," Targeted Threat Intelligence (TTI) #4 - Flags"),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Tasks:")," "),(0,r.kt)("li",null,"Task #1 - Flags"),(0,r.kt)("br",null),(0,r.kt)("p",null,"\ud83d\udd0e ",(0,r.kt)("a",{href:"https://github.com/jstnk9/TIBER-Cases/blob/main/cases/threat_intelligence_provider/Case-Template__Targeted_Threat_Intelligence_TTI_4_Flags.json",target:"_blank"}," JSON File "))),(0,r.kt)(s.Z,{value:"TTI - Step 5",label:"TTI - Step 5",mdxType:"TabItem"},(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Case name:")," Targeted Threat Intelligence (TTI) #5 - Scenarios"),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Tasks:")," "),(0,r.kt)("li",null,"Task #1 - Create Scenarios "),(0,r.kt)("li",null,"Task #2 - Reconnaissance"),(0,r.kt)("li",null,"Task #3 - Weaponization "),(0,r.kt)("li",null,"Task #4 - Delivery "),(0,r.kt)("li",null,"Task #5 - Exploitation "),(0,r.kt)("li",null,"Task #6 - Installation "),(0,r.kt)("li",null,"Task #7 - C2 "),(0,r.kt)("li",null,"Task #8 - Actions on Objectives"),(0,r.kt)("br",null),(0,r.kt)("p",null,"\ud83d\udd0e ",(0,r.kt)("a",{href:"https://github.com/jstnk9/TIBER-Cases/blob/main/cases/threat_intelligence_provider/Case-Template__Targeted_Threat_Intelligence_TTI_5_Scenarios.json",target:"_blank"}," JSON File "))))),(0,r.kt)("h2",null," Contact "),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Twitter"),": ",(0,r.kt)("a",{parentName:"p",href:"https://twitter.com/Joseliyo_Jstnk"},"https://twitter.com/Joseliyo_Jstnk")),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"LinkedIn"),": ",(0,r.kt)("a",{parentName:"p",href:"https://www.linkedin.com/in/joseluissm/"},"https://www.linkedin.com/in/joseluissm/")),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"GitHub Project"),": ",(0,r.kt)("a",{parentName:"p",href:"https://github.com/jstnk9/TIBER-Cases"},"https://github.com/jstnk9/TIBER-Cases")))}k.isMDXComponent=!0}}]);