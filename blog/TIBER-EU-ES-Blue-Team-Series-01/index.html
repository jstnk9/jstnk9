<!doctype html>
<html lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.8">
<link rel="alternate" type="application/rss+xml" href="/jstnk9/blog/rss.xml" title="Welcome to Jstnk webpage RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/jstnk9/blog/atom.xml" title="Welcome to Jstnk webpage Atom Feed">
<link rel="alternate" type="application/rss+xml" href="/jstnk9/research/rss.xml" title="Welcome to Jstnk webpage RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/jstnk9/research/atom.xml" title="Welcome to Jstnk webpage Atom Feed">
<link rel="alternate" type="application/rss+xml" href="/jstnk9/malwareandhunting/rss.xml" title="Welcome to Jstnk webpage RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/jstnk9/malwareandhunting/atom.xml" title="Welcome to Jstnk webpage Atom Feed"><title data-react-helmet="true">TIBER-EU and TIBER-ES - Blue Team | Welcome to Jstnk webpage</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:url" content="https://jstnk9.github.io/jstnk9/blog/TIBER-EU-ES-Blue-Team-Series-01"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_tag" content="default"><meta data-react-helmet="true" property="og:title" content="TIBER-EU and TIBER-ES - Blue Team | Welcome to Jstnk webpage"><meta data-react-helmet="true" name="description" content="TL;DR"><meta data-react-helmet="true" property="og:description" content="TL;DR"><meta data-react-helmet="true" property="og:type" content="article"><meta data-react-helmet="true" property="article:published_time" content="2022-07-11T00:00:00.000Z"><meta data-react-helmet="true" property="article:author" content="https://twitter.com/Joseliyo_Jstnk"><meta data-react-helmet="true" property="article:tag" content="threat intelligence,blue team,cybersecurity,risk,threat modeling,financial services,tiber-eu,tiber-es"><link data-react-helmet="true" rel="shortcut icon" href="/jstnk9/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://jstnk9.github.io/jstnk9/blog/TIBER-EU-ES-Blue-Team-Series-01"><link data-react-helmet="true" rel="alternate" href="https://jstnk9.github.io/jstnk9/blog/TIBER-EU-ES-Blue-Team-Series-01" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://jstnk9.github.io/jstnk9/blog/TIBER-EU-ES-Blue-Team-Series-01" hreflang="x-default"><link rel="stylesheet" href="/jstnk9/assets/css/styles.26cc7d61.css">
<link rel="preload" href="/jstnk9/assets/js/runtime~main.f4b21a33.js" as="script">
<link rel="preload" href="/jstnk9/assets/js/main.f0c50aa8.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><a href="#" class="skipToContent_OuoZ">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/jstnk9/"><div class="navbar__logo"><img src="/jstnk9/img/msq.png" alt="logo" class="themedImage_TMUO themedImage--light_4Vu1"><img src="/jstnk9/img/msq.png" alt="logo" class="themedImage_TMUO themedImage--dark_uzRr"></div></a><a class="navbar__item navbar__link" href="/jstnk9/docs/intro">Home</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/jstnk9/blog">Blog</a><a class="navbar__item navbar__link" href="/jstnk9/research">Research</a><a class="navbar__item navbar__link" href="/jstnk9/malwareandhunting">Malware &amp; Hunting</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/jstnk9" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><div class="toggle_iYfV toggle_2i4l toggleDisabled_xj38"><div class="toggleTrack_t-f2" role="button" tabindex="-1"><div class="toggleTrackCheck_mk7D"><span class="toggleIcon_pHJ9">ðŸŒœ</span></div><div class="toggleTrackX_dm8H"><span class="toggleIcon_pHJ9">ðŸŒž</span></div><div class="toggleTrackThumb_W6To"></div></div><input type="checkbox" class="toggleScreenReader_h9qa" aria-label="Switch between dark and light mode"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper blog-wrapper blog-post-page"><div class="container margin-vert--lg"><div class="row"><aside class="col col--3"><nav class="sidebar_q+wC thin-scrollbar" aria-label="Blog recent posts navigation"><div class="sidebarItemTitle_9G5K margin-bottom--md">All posts</div><ul class="sidebarItemList_6T4b"><li class="sidebarItem_cjdF"><a class="sidebarItemLink_zyXk" href="/jstnk9/blog/MISP-object-creator-with-Virustotal-and-Sigma">MISP object creator with VirusTotal and Sigma Galaxies</a></li><li class="sidebarItem_cjdF"><a class="sidebarItemLink_zyXk" href="/jstnk9/blog/Sigma-Rules-as-MISP-galaxies-02">Sigma Rules as MISP galaxies (II)</a></li><li class="sidebarItem_cjdF"><a class="sidebarItemLink_zyXk" href="/jstnk9/blog/Sigma-Rules-as-MISP-galaxies">Sigma Rules as MISP galaxies</a></li><li class="sidebarItem_cjdF"><a aria-current="page" class="sidebarItemLink_zyXk sidebarItemLinkActive_wcJs" href="/jstnk9/blog/TIBER-EU-ES-Blue-Team-Series-01">TIBER-EU and TIBER-ES - Blue Team</a></li><li class="sidebarItem_cjdF"><a class="sidebarItemLink_zyXk" href="/jstnk9/blog/ETW-Almulahaza">ETW-Almulahaza - new python-based tool</a></li><li class="sidebarItem_cjdF"><a class="sidebarItemLink_zyXk" href="/jstnk9/blog/TIBER-EU-ES-Red-Team-Series-01">TIBER-EU and TIBER-ES - Red Team</a></li><li class="sidebarItem_cjdF"><a class="sidebarItemLink_zyXk" href="/jstnk9/blog/TIBER-EU-ES-Threat-Intelligence-Series-01">TIBER-EU and TIBER-ES - Threat Intelligence (I)</a></li><li class="sidebarItem_cjdF"><a class="sidebarItemLink_zyXk" href="/jstnk9/blog/Threat-modeling-and-strategic-vision-of-risks">Threat modeling and strategic vision of risks</a></li><li class="sidebarItem_cjdF"><a class="sidebarItemLink_zyXk" href="/jstnk9/blog/Indicator-life-cycle-applied-to-threat-hunting">Indicator life cycle applied to threat hunting</a></li><li class="sidebarItem_cjdF"><a class="sidebarItemLink_zyXk" href="/jstnk9/blog/TypeRef Hasher-The-imphash-solution-for-samples-in-NET">TypeRef Hasher- The imphash solution for samples in .NET</a></li><li class="sidebarItem_cjdF"><a class="sidebarItemLink_zyXk" href="/jstnk9/blog/Threat-hunting-but-where-and-what-collection-management-framework">Threat Hunting, but... Where and what? - Collection Management Framework</a></li></ul></nav></aside><main class="col col--7" itemscope="" itemtype="http://schema.org/Blog"><article itemprop="blogPost" itemscope="" itemtype="http://schema.org/BlogPosting"><header><h1 class="blogPostTitle_d4p0" itemprop="headline">TIBER-EU and TIBER-ES - Blue Team</h1><div class="blogPostData_-Im+ margin-vert--md"><time datetime="2022-07-11T00:00:00.000Z" itemprop="datePublished">July 11, 2022</time> Â· <!-- -->11 min read</div><div class="row margin-top--md margin-bottom--sm"><div class="col col--6 authorCol_8c0z"><div class="avatar margin-bottom--sm"><a href="https://twitter.com/Joseliyo_Jstnk" target="_blank" rel="noopener noreferrer" class="avatar__photo-link avatar__photo"><img class="image_9q7L" src="https://jstnk9.github.io/jstnk9/img/profiles/1574890680450.jpeg" alt="Jose Luis SÃ¡nchez MartÃ­nez"></a><div class="avatar__intro" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="avatar__name"><a href="https://twitter.com/Joseliyo_Jstnk" target="_blank" rel="noopener noreferrer" itemprop="url"><span itemprop="name">Jose Luis SÃ¡nchez MartÃ­nez</span></a></div><small class="avatar__subtitle" itemprop="description">Security Researcher</small></div></div></div></div></header><div class="markdown" itemprop="articleBody"><h2 class="anchor anchorWithStickyNavbar_y2LR" id="tldr">TL;DR<a aria-hidden="true" class="hash-link" href="#tldr" title="Direct link to heading">â€‹</a></h2><p>Previous blogs: </p><ul><li><a href="https://jstnk9.github.io/jstnk9/blog/TIBER-EU-ES-Threat-Intelligence-Series-01" target="_blank" rel="noopener noreferrer">https://jstnk9.github.io/jstnk9/blog/TIBER-EU-ES-Threat-Intelligence-Series-01</a></li><li><a href="https://jstnk9.github.io/jstnk9/blog/TIBER-EU-ES-Red-Team-Series-01" target="_blank" rel="noopener noreferrer">https://jstnk9.github.io/jstnk9/blog/TIBER-EU-ES-Red-Team-Series-01</a></li></ul><p>This is the last entry related to TIBER-EU and TIBER-ES. So far we have seen the processes related to <a href="https://jstnk9.github.io/jstnk9/blog/TIBER-EU-ES-Threat-Intelligence-Series-01" target="_blank" rel="noopener noreferrer">Threat Intelligence</a> and <a href="https://jstnk9.github.io/jstnk9/blog/TIBER-EU-ES-Red-Team-Series-01" target="_blank" rel="noopener noreferrer">Red Team</a>. Now it is the turn to learn about the Blue Team process, which, unlike the last two, is the <code>Entity</code> Blue Team itself. This team can be outsourced or belong to <code>Entity</code> itself, and its objective is to detect and defend the <code>Entity</code> business in case of an attack.</p><p>During the implementation of TIBER-EU, the Blue Team is not aware that any penetration test will be performed, so they must be able to detect the attacks performed by the Red Team provider. Subsequently, they must generate reports relating the Red Team&#x27;s attacks to the Blue Team&#x27;s findings.</p><p>As I did in the previous case, I have developed some cases in the <strong><a href="https://thehive-project.org/" target="_blank" rel="noopener noreferrer">The Hive</a></strong>  tool so that blue team teams can import them quickly and know the different actions that they have to carry out, thus allowing the use of the Task logs to document and attach everything that they carry out on the test.</p><p>The developed cases contemplate all the phases that TIBER-EU mentions in its documentation, in addition I have also included good practices and ways of facing some phases.</p><p>The fact of using The Hive is due to the following reasons:</p><ul><li>Allows to merge cases</li><li>Can be integrated with MISP</li><li>Can be integrated with Cortex and its analyzers</li><li>Case templates can be created</li></ul><p><strong>GitHub project</strong>: <a href="https://github.com/jstnk9/TIBER-Cases" target="_blank" rel="noopener noreferrer">https://github.com/jstnk9/TIBER-Cases</a></p><h2 class="anchor anchorWithStickyNavbar_y2LR" id="abbreviations">Abbreviations<a aria-hidden="true" class="hash-link" href="#abbreviations" title="Direct link to heading">â€‹</a></h2><table><thead><tr><th>Key</th><th>Description</th></tr></thead><tbody><tr><td>Entity</td><td>The term Entity during this blog and The Hive cases, refers to the entity that is going to carry out the TIBER-EU exercises.</td></tr><tr><td>TI</td><td>Threat Intelligence Provider. Is the provider of threat intelligence services for the Entity.</td></tr><tr><td>RT</td><td>Red Team Provider. Is the provider of red teaming services for the Entity.</td></tr><tr><td>WT</td><td>White Team. Team responsible of the scope and operative execution of the exercises.</td></tr><tr><td>BT</td><td>Blue Team. Team without  knowledge about the exercise which have to respond to the attacks by the RT.</td></tr></tbody></table><h2 class="anchor anchorWithStickyNavbar_y2LR" id="context">Context<a aria-hidden="true" class="hash-link" href="#context" title="Direct link to heading">â€‹</a></h2><p>During this blog I will not go into detail about what TIBER-EU or TIBER-ES is. I will simply mention that TIBER-EU is a European framework for testing red teaming with a threat intelligence approach. This approach is related to Lockheed Martin&#x27;s well-known Intelligence Driven DefenseÂ® method.</p><p>The offensive tests will be from the perspective of actual attacks with procedures used by actors targeting the financial sector. For more information, I recommend reading the TIBER-EU and TIBER-ES guides.</p><div class="admonition admonition-info alert alert--info"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</h5></div><div class="admonition-content"><p><strong>TIBER-EU Information: <a href="https://www.ecb.europa.eu/paym/cyber-resilience/tiber-eu/html/index.en.html" target="_blank" rel="noopener noreferrer">https://www.ecb.europa.eu/paym/cyber-resilience/tiber-eu/html/index.en.html</a></strong></p><p><strong>TIBER-ES Information: <a href="https://www.bde.es/bde/es/secciones/servicios/tiber-es-3f6bfe7e907ed71.html" target="_blank" rel="noopener noreferrer">https://www.bde.es/bde/es/secciones/servicios/tiber-es-3f6bfe7e907ed71.html</a></strong></p></div></div><h2 class="anchor anchorWithStickyNavbar_y2LR" id="goal-of-this-project-and-blog">Goal of this project and blog<a aria-hidden="true" class="hash-link" href="#goal-of-this-project-and-blog" title="Direct link to heading">â€‹</a></h2><p>The main objective of this project is to <strong>help blue team analysts</strong> during the blue team closure phase (so called by TIBER-EU). For this purpose, different cases are made available which can be imported into The Hive in order to speed up the work.</p><p>For this purpose, a total of 3 cases have been developed, which have sub-tasks assigned so that blue team analysts can execute their actions from there. Additionally, there are some tasks where the participation of red team and detection engineering analysts is required.</p><p>Finally, in the phases and steps that come in this blog, I will not go into too much detail about what to do, since, in the very cases I have developed from The Hive, I put the necessary information for the analysts.</p><h2 class="anchor anchorWithStickyNavbar_y2LR" id="process">Process<a aria-hidden="true" class="hash-link" href="#process" title="Direct link to heading">â€‹</a></h2><p>The process that TIBER-EU defines for the blue team during the closure phase is as shown below:</p><p><img src="https://jstnk9.github.io/jstnk9/img/blog-tiber03/process_bttiber.png" alt="tiberBlueTeam_process"></p><p>Source: ecb.europa.eu </p><p>To simplify the entire TIBER-EU document and the blue team section a bit, I wanted to make a process explaining the most important points of the framework for those analysts who are going to work on it. Specifically, I have focused on the &quot;Processes/Activities Closure Phase&quot; section of the official TIBER-EU process.</p><p><img src="https://jstnk9.github.io/jstnk9/img/blog-tiber03/bt_process.png" alt="jstnk_tiber"></p><h3 class="anchor anchorWithStickyNavbar_y2LR" id="notify-the-blue-team-of-the-tests-performed">Notify the blue team of the tests performed<a aria-hidden="true" class="hash-link" href="#notify-the-blue-team-of-the-tests-performed" title="Direct link to heading">â€‹</a></h3><p><img src="https://jstnk9.github.io/jstnk9/img/blog-tiber03/01_dark.png#gh-dark-mode-only" alt="rttestingplandark"><img src="https://jstnk9.github.io/jstnk9/img/blog-tiber03/01_white.png#gh-light-mode-only" alt="rttestingplanlight"></p><p>First, after the red team has executed the tests as discussed in the <a href="https://jstnk9.github.io/jstnk9/blog/TIBER-EU-ES-Red-Team-Series-01" target="_blank" rel="noopener noreferrer">previous entry</a>, it must notify the blue team about the exercises performed.</p><p>The ideal scenario is that the blue team knows without warning that they are under attack (always, without knowing that the TIBER processes are running). This will mean that there are detection mechanisms in place for some of the steps performed by the red team.</p><p>in any case, the blue team must know the tests that the red team performed during its testing phase once it is finished, and for this purpose, they must receive a copy of the complete report made by the red team (red team report).</p><p>In many cases, the blue team will be an internal <code>Entity</code> team, in other cases, this team will be an outsourced team providing services to the <code>Entity</code> being targeted by the TIBER-EU Framework.</p><h3 class="anchor anchorWithStickyNavbar_y2LR" id="blue-team-report">Blue Team Report<a aria-hidden="true" class="hash-link" href="#blue-team-report" title="Direct link to heading">â€‹</a></h3><p><img src="https://jstnk9.github.io/jstnk9/img/blog-tiber03/02_dark.png#gh-dark-mode-only" alt="methdark"><img src="https://jstnk9.github.io/jstnk9/img/blog-tiber03/02_white.png#gh-light-mode-only" alt="methlight"></p><p>This phase is very important for the blue team. </p><p><strong>As a red teamer</strong>, your goal is to help the blue team and explain in as much detail as possible the steps taken during the testing phase. Think that this collaboration with the blue team will be key to improve the security posture and minimize risks in the <code>Entity</code>.</p><p><strong>As a blue teamer</strong>, your objective is to relate each step taken by the red teamer to possible detections in your technology that evidence the step taken by the red teamer.</p><p>By detection we mean that there is some kind of notification or something similar where it indicates that suspicious behavior has been detected. Usually these detections cover some kind of pattern previously generated either by an <code>Entity</code> analyst or by the vendor providing the solution.</p><p>Once we have a list of those steps detected and those steps not detected, let&#x27;s focus on those NOT detected. For those tests performed by the red team where there was no detection, we must ask ourselves the following question... <strong>Did I not detect it because there is no visibility, or because there is no detection mechanism?</strong>.</p><p>First, it is advisable to review those gaps and map them to a data source, i.e., a technology or feature of the operating system that might know that the technique was executed. For example, if we are looking for process injection, we might have a chance for visibility through </p><ol><li>Windows API calls</li><li>Process modification</li><li>Process access</li></ol><p>According to ATT&amp;CK MITRE, the above three points could help us to identify the T1055.003 technique. Therefore, as a blue teamer, we have to keep this information in mind so that later, in the next phases when the red team repeats the test, we look at those places where we can see the executed step. </p><h3 class="anchor anchorWithStickyNavbar_y2LR" id="replay-the-test">Replay the test<a aria-hidden="true" class="hash-link" href="#replay-the-test" title="Direct link to heading">â€‹</a></h3><p><img src="https://jstnk9.github.io/jstnk9/img/blog-tiber03/03_dark.png#gh-dark-mode-only" alt="repalydark"><img src="https://jstnk9.github.io/jstnk9/img/blog-tiber03/03_white.png#gh-light-mode-only" alt="repalywhite"></p><p>In this case, the blue teamers have to be able to at least see some kind of evidence in the steps repeated by the red team. That would mean that there is at least some kind of visibility.</p><p>In case there is no evidence on a step performed by the red team, it could mean that there is no visibility, which would mean either acquiring new technology to fill the gap or asking possible engineering teams from the <code>Entity</code> to fill the visibility gap.</p><p>There is a lot of technology and each one uses different formats for the generation of detections, therefore, it is recommended to use <a href="https://github.com/SigmaHQ/sigma" target="_blank" rel="noopener noreferrer">SIGMA</a> Rules for those cases where the detection can be covered with this scheme. This could later help us when translating the detection to our technology using <a href="https://github.com/SigmaHQ/sigma/blob/master/tools/README.md" target="_blank" rel="noopener noreferrer">sigmac</a> and/or <a href="https://uncoder.io/" target="_blank" rel="noopener noreferrer">uncoder.io</a>.</p><p>For the development of detections, there must be a previous investigation, where the analysts must be able to cover the required behavior and with the least possible number (or none at all) of false positives. In this way, we will avoid a lot of unnecessary noise and possible alert fatigue.</p><p>Finally, the implementation of the developed detections should be carried out. In this case, there may be different teams responsible for this work, depending on each entity, the team may vary.</p><h3 class="anchor anchorWithStickyNavbar_y2LR" id="remediation-plan-and-test-summary-report">Remediation Plan and Test Summary Report<a aria-hidden="true" class="hash-link" href="#remediation-plan-and-test-summary-report" title="Direct link to heading">â€‹</a></h3><p><img src="https://jstnk9.github.io/jstnk9/img/blog-tiber03/04_dark.png#gh-dark-mode-only" alt="remedark"><img src="https://jstnk9.github.io/jstnk9/img/blog-tiber03/04_white.png#gh-light-mode-only" alt="remewhit"></p><p>The blue team is not the only stakeholder for this phase. In this case, IR, Threat Intelligence, SOC, Architecture teams, etc. must be involved and coordinated to develop a remediation plan based on those vulnerabilities and failures identified during the red team tests.</p><p>The reports that must be generated in this case are the following:</p><ol><li><p><strong>Remediation Plan</strong>: The Remediation Plan is based on the test results, which should be used in turn to support the business case for implementing improvements to mitigate the vulnerabilities identified during the TIBER-EU test.</p></li><li><p><strong>Test Summary Report</strong>: The Test Summary Report summarises the overall test process and results (including the Remediation Plan) and should draw on the test documentation, such as the Red Team Test Report, the Blue Team Report, the TTI Report, the Red Team Test Plan and the Remediation Plan. The Test Summary Report should not contain detailed technical information and findings regarding weaknesses and vulnerabilities, as information at that level of detail is highly sensitive and for the entity only. The entity must share the Test Summary Report with the lead authority. The lead authority may also review the more detailed findings from the test if this is deemed necessary.</p></li></ol><h2 class="anchor anchorWithStickyNavbar_y2LR" id="import-case-in-the-hive">Import case in The Hive<a aria-hidden="true" class="hash-link" href="#import-case-in-the-hive" title="Direct link to heading">â€‹</a></h2><p>Version of The Hive used:</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI yaml"><pre tabindex="0" class="prism-code language-yaml codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">Scalligraph</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> 0.1.0</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">SNAPSHOT</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">TheHive</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> 4.1.18</span><span class="token punctuation" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">Play</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> 2.8.7</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>Before you begin, I highly recommend following the guide below to import the ATT&amp;CK MITRE Matrix and MISP taxonomies into The Hive. To do this, go to the following links.</p><div class="admonition admonition-info alert alert--info"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</h5></div><div class="admonition-content"><p>Import ATT&amp;CK MITRE: <a href="https://docs.thehive-project.org/thehive/user-guides/administrators/tactics-techniques-procedures/" target="_blank" rel="noopener noreferrer">https://docs.thehive-project.org/thehive/user-guides/administrators/tactics-techniques-procedures/</a></p><p>Import MISP Taxonomies: <a href="https://docs.thehive-project.org/thehive/user-guides/administrators/tags-and-taxonomies/" target="_blank" rel="noopener noreferrer">https://docs.thehive-project.org/thehive/user-guides/administrators/tags-and-taxonomies/</a></p></div></div><p>To import the cases, you must have permissions to perform this task. To do this, you must first navigate to the <code>Organization</code> section that is located at the top next to the search bar.</p><p><img src="https://jstnk9.github.io/jstnk9/img/blog-tiber01/tutorial1.png" alt="step1"></p><p>Once inside that section, we will have to go to the section that says <code>Import template</code> and select the JSON files that are in my GitHub, specifically in the <code>cases</code> folder.</p><p><img src="https://jstnk9.github.io/jstnk9/img/blog-tiber01/tutorial2.png" alt="step2"></p><p>Once this is done, and when we click on the upper part where it says <code>+ New Case</code>, all the imported cases will appear with the information about the TIBER-EU phases.</p><p><img src="https://jstnk9.github.io/jstnk9/img/blog-tiber01/tutorial3.png" alt="step3"></p><h2 class="anchor anchorWithStickyNavbar_y2LR" id="case-previsualization">Case previsualization<a aria-hidden="true" class="hash-link" href="#case-previsualization" title="Direct link to heading">â€‹</a></h2><p>As an example, once the cases are imported and one is generated to start working on it, they look like the following image:</p><p><img src="https://jstnk9.github.io/jstnk9/img/blog-tiber03/high_level_case.png" alt="gtl_case"></p><p>As can be seen, it contains all the information the analyst needs to start working. The way cases are written is by using <code>markdown</code>.</p><p>When clicking on <code>tasks</code>, the user can see the following information.</p><p><img src="https://jstnk9.github.io/jstnk9/img/blog-tiber03/low_level_task.png" alt="gtl_case_tasks"></p><p>All the Tasks that are included in each case have <code>dependencies</code> and <code>goals</code>, this will help the analysts not lose focus and focus on the goals to be achieved.</p><h3 class="anchor anchorWithStickyNavbar_y2LR" id="cases-information">Cases information<a aria-hidden="true" class="hash-link" href="#cases-information" title="Direct link to heading">â€‹</a></h3><p>Here you can find basic information about the created cases. Case name is the name defined for each case. Each case has different tasks to complete. You&#x27;ll find all the information in the json files.</p><div class="browserWindow_CU2T"><div class="browserWindowHeader_9KMa"><div class="buttons_HaVU"><span class="dot_AgBE" style="background:#f25f58"></span><span class="dot_AgBE" style="background:#fbbe3c"></span><span class="dot_AgBE" style="background:#58cb42"></span></div><div class="browserWindowAddressBar_ep3W">http://thehive:9000/cases/</div><div class="browserWindowMenuIcon_mrOC"><div><span class="bar_CAZr"></span><span class="bar_CAZr"></span><span class="bar_CAZr"></span></div></div></div><div class="browserWindowBody_jHfO"><div class="tabs-container"><ul role="tablist" aria-orientation="horizontal" class="tabs"><li role="tab" tabindex="0" aria-selected="true" class="tabs__item tabItem_vU9c tabs__item--active">Blue Team Report</li><li role="tab" tabindex="-1" aria-selected="false" class="tabs__item tabItem_vU9c">Red Team Replay</li><li role="tab" tabindex="-1" aria-selected="false" class="tabs__item tabItem_vU9c">Remediation Plan and Test Summary Report</li></ul><div class="margin-vert--md"><div role="tabpanel"><p><strong>Case name:</strong> Closure Blue Team #1 - Report</p><p><strong>Tasks:</strong></p><li>Task #1 - Inform key people</li><li>Task #2 - Map red team&#x27;s attacks with blue team detection</li><li>Task #3 - Identify detection gaps</li><br><p>ðŸ”Ž <a href="https://github.com/jstnk9/TIBER-Cases/blob/main/cases/blue_team/Case-Template__Closure_phase__BT_Report.json" target="_blank" rel="noopener noreferrer"> JSON File </a></p></div><div role="tabpanel" hidden=""><p><strong>Case name:</strong> Closure Blue Team #2 - Replay</p><p><strong>Tasks:</strong></p><li>Task #1 - Repeat those undetected steps by the blue team</li><li>Task #2 - Check visibility</li><li>Task #3 - Develop detection </li><li>Task #4 - Implement Detections </li><p>ðŸ”Ž <a href="https://github.com/jstnk9/TIBER-Cases/blob/main/cases/blue_team/Case-Template__Closure_phase__BT_Replay.json" target="_blank" rel="noopener noreferrer"> JSON File </a></p></div><div role="tabpanel" hidden=""><p><strong>Case name:</strong>Closure Blue Team #3 - Remediation Plan and Test Summary Report</p><p><strong>Tasks:</strong></p><li>Task #1 - Remediation Plan </li><li>Task #2 - Test Summary Report</li><p>ðŸ”Ž <a href="https://github.com/jstnk9/TIBER-Cases/blob/main/cases/blue_team/Case-Template__Closure_phase__BT_Remediation_and_Summary.json" target="_blank" rel="noopener noreferrer"> JSON File </a></p></div></div></div></div></div><h2> Contact </h2><p><strong>Twitter</strong>: <a href="https://twitter.com/Joseliyo_Jstnk" target="_blank" rel="noopener noreferrer">https://twitter.com/Joseliyo_Jstnk</a></p><p><strong>LinkedIn</strong>: <a href="https://www.linkedin.com/in/joseluissm/" target="_blank" rel="noopener noreferrer">https://www.linkedin.com/in/joseluissm/</a></p><p><strong>GitHub Project</strong>: <a href="https://github.com/jstnk9/TIBER-Cases" target="_blank" rel="noopener noreferrer">https://github.com/jstnk9/TIBER-Cases</a></p></div><footer class="row docusaurus-mt-lg blogPostDetailsFull_xD8n"><div class="col"><b>Tags:</b><ul class="tags_NBRY padding--none margin-left--sm"><li class="tag_F03v"><a class="tag_WK-t tagRegular_LXbV" href="/jstnk9/blog/tags/threat-intelligence">threat intelligence</a></li><li class="tag_F03v"><a class="tag_WK-t tagRegular_LXbV" href="/jstnk9/blog/tags/blue-team">blue team</a></li><li class="tag_F03v"><a class="tag_WK-t tagRegular_LXbV" href="/jstnk9/blog/tags/cybersecurity">cybersecurity</a></li><li class="tag_F03v"><a class="tag_WK-t tagRegular_LXbV" href="/jstnk9/blog/tags/risk">risk</a></li><li class="tag_F03v"><a class="tag_WK-t tagRegular_LXbV" href="/jstnk9/blog/tags/threat-modeling">threat modeling</a></li><li class="tag_F03v"><a class="tag_WK-t tagRegular_LXbV" href="/jstnk9/blog/tags/financial-services">financial services</a></li><li class="tag_F03v"><a class="tag_WK-t tagRegular_LXbV" href="/jstnk9/blog/tags/tiber-eu">tiber-eu</a></li><li class="tag_F03v"><a class="tag_WK-t tagRegular_LXbV" href="/jstnk9/blog/tags/tiber-es">tiber-es</a></li></ul></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Blog post page navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/jstnk9/blog/Sigma-Rules-as-MISP-galaxies"><div class="pagination-nav__sublabel">Newer Post</div><div class="pagination-nav__label">Â« <!-- -->Sigma Rules as MISP galaxies</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/jstnk9/blog/ETW-Almulahaza"><div class="pagination-nav__sublabel">Older Post</div><div class="pagination-nav__label">ETW-Almulahaza - new python-based tool<!-- --> Â»</div></a></div></nav></main><div class="col col--2"><div class="tableOfContents_vrFS thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#tldr" class="table-of-contents__link toc-highlight">TL;DR</a></li><li><a href="#abbreviations" class="table-of-contents__link toc-highlight">Abbreviations</a></li><li><a href="#context" class="table-of-contents__link toc-highlight">Context</a></li><li><a href="#goal-of-this-project-and-blog" class="table-of-contents__link toc-highlight">Goal of this project and blog</a></li><li><a href="#process" class="table-of-contents__link toc-highlight">Process</a><ul><li><a href="#notify-the-blue-team-of-the-tests-performed" class="table-of-contents__link toc-highlight">Notify the blue team of the tests performed</a></li><li><a href="#blue-team-report" class="table-of-contents__link toc-highlight">Blue Team Report</a></li><li><a href="#replay-the-test" class="table-of-contents__link toc-highlight">Replay the test</a></li><li><a href="#remediation-plan-and-test-summary-report" class="table-of-contents__link toc-highlight">Remediation Plan and Test Summary Report</a></li></ul></li><li><a href="#import-case-in-the-hive" class="table-of-contents__link toc-highlight">Import case in The Hive</a></li><li><a href="#case-previsualization" class="table-of-contents__link toc-highlight">Case previsualization</a><ul><li><a href="#cases-information" class="table-of-contents__link toc-highlight">Cases information</a></li></ul></li></ul></div></div></div></div></div><footer class="footer footer--dark"><div class="container"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/jstnk9/docs/intro">Home</a></li><li class="footer__item"><a class="footer__link-item" href="/jstnk9/blog">Blog</a></li></ul></div><div class="col footer__col"><div class="footer__title">Social Media</div><ul class="footer__items"><li class="footer__item"><a href="https://twitter.com/Joseliyo_Jstnk" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Twitter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="https://www.linkedin.com/in/joseluissm/" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>LinkedIn<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items"><li class="footer__item"><a href="https://github.com/jstnk9" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright Â© 2023 Jstnk Website.</div></div></div></footer></div>
<script src="/jstnk9/assets/js/runtime~main.f4b21a33.js"></script>
<script src="/jstnk9/assets/js/main.f0c50aa8.js"></script>
</body>
</html>